<div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.2/Chart.min.js"></script>
    <script id="chart-js1">
        {{DATASET}}
        window.chartColors = {
            red: 'rgb(255, 99, 132)',
            darkRed: 'rgb(174, 4, 4)',
            fillDarkRed: 'rgb(174, 4, 4, 0.7)',
            orange: 'rgb(255, 159, 64)',
            yellow: 'rgb(255,230,0)',
            green: 'rgb(75,192,192)',
            darkGreen: 'rgb(0, 165, 58)',
            blue: 'rgb(54,162,235)',
            fillBlue: 'rgba(141,197,255,0.7)',
            darkBlue: 'rgb(0, 83, 250)',
            fillDarkBlue: 'rgb(205, 221, 255, 0.7)',
            purple: 'rgb(153, 102, 255)',
            grey: 'rgb(231,233,237)',
            black: 'rgb(0,0,0)',
            fillGrayTransparent: 'rgb(241,241,241, 0.5)',
            purple: 'rgb(145, 0, 162)',
            fillPurple: 'rgb(188, 0, 174, 0.5)'
        };
        var TASK_STYLE_CHART = 'line';
        var WORKERS_STYLE_CHART = 'line';
        var HIDE_MAX_WORKERS = false;
        var HIDE_MIN_WORKERS = false;
        var HIDE_MIN_IDLE_WORKERS = false;
        var WORKERS_STEPPED_STYLE = false;
        var WORKERS_FILL_STYLE = true;
        var myChart;
        window.addEventListener("load", () => {
            initChart1();
        }, false);

        function initChart1() {
            var chartContainer = document.getElementById('chart-container');
            var canvas = document.createElement('canvas');
            chartContainer.appendChild(canvas);
            myChart = new Chart(canvas, {
                type: 'line',
                data: {
                    labels: labelsList,
                    datasets: [{
                        label: 'Max workers',
                        type: WORKERS_STYLE_CHART,
                        data: maxWorkersList,
                        fill: false,
                        borderColor: window.chartColors.darkRed,
                        backgroundColor: window.chartColors.grey,
                        borderWidth: 2,
                        borderDash: [2, 2],
                        pointRadius: 0,
                        steppedLine: true,
                        hidden: HIDE_MAX_WORKERS,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Min workers',
                        type: WORKERS_STYLE_CHART,
                        data: minWorkersList,
                        fill: false,
                        borderColor: window.chartColors.darkGreen,
                        backgroundColor: window.chartColors.grey,
                        borderWidth: 2,
                        borderDash: [2, 2],
                        pointRadius: 0,
                        steppedLine: true,
                        hidden: HIDE_MIN_WORKERS,
                        yAxisID: 'WORKERS',
                    },
                    {
                        label: 'Min Iddle Workers',
                        type: WORKERS_STYLE_CHART,
                        data: minIdleWorkers,
                        fill: false,
                        borderColor: window.chartColors.darkGreen,
                        backgroundColor: window.chartColors.darkGreen,
                        borderWidth: 3,
                        borderDash: [10, 15],
                        pointRadius: 0,
                        steppedLine: true,
                        hidden: HIDE_MIN_IDLE_WORKERS,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Launching Workers',
                        type: WORKERS_STYLE_CHART,
                        data: launchingWorkers,
                        fill: false,
                        borderColor: window.chartColors.yellow,
                        backgroundColor: window.chartColors.yellow,
                        borderWidth: 2,
                        steppedLine: WORKERS_STEPPED_STYLE,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Disconnected Workers',
                        type: WORKERS_STYLE_CHART,
                        data: disconnectedWorkers,
                        fill: false,
                        borderColor: window.chartColors.purple,
                        backgroundColor: window.chartColors.fillPurple,
                        borderWidth: 2,
                        steppedLine: WORKERS_STEPPED_STYLE,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Iddle Workers',
                        type: WORKERS_STYLE_CHART,
                        data: idleWorkers,
                        fill: true,
                        borderColor: window.chartColors.orange,
                        backgroundColor: window.chartColors.orange,
                        borderWidth: 2,
                        steppedLine: WORKERS_STEPPED_STYLE,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Terminating Workers',
                        type: WORKERS_STYLE_CHART,
                        data: terminatingWorkers,
                        fill: false,
                        borderColor: window.chartColors.red,
                        backgroundColor: window.chartColors.red,
                        borderWidth: 2,
                        steppedLine: WORKERS_STEPPED_STYLE,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Running Workers',
                        type: WORKERS_STYLE_CHART,
                        data: runningWorkers,
                        fill: WORKERS_FILL_STYLE,
                        borderColor: window.chartColors.green,
                        backgroundColor: window.chartColors.green,
                        borderWidth: 2,
                        steppedLine: WORKERS_STEPPED_STYLE,
                        yAxisID: 'WORKERS',
                    }, {
                        label: 'Queued High Priority Tasks',
                        type: TASK_STYLE_CHART,
                        data: highPriorityTasks,
                        fill: false,
                        borderColor: window.chartColors.darkRed,
                        borderWidth: 2,
                        yAxisID: 'TASKS',
                    }, {
                        label: 'Queued Low Priority Tasks',
                        type: TASK_STYLE_CHART,
                        data: lowPriorityTasks,
                        fill: false,
                        borderColor: window.chartColors.orange,
                        borderWidth: 2,
                        yAxisID: 'TASKS',
                    }, {
                        label: 'Total Queued tasks',
                        type: TASK_STYLE_CHART,
                        data: totalTasks,
                        fill: false,
                        borderColor: window.chartColors.darkBlue,
                        borderWidth: 2,
                        hidden: false,
                        yAxisID: 'TASKS',
                    },
                    {
                        label: 'Running tasks',
                        type: TASK_STYLE_CHART,
                        data: runningTasks,
                        fill: false,
                        borderColor: window.chartColors.purple,
                        borderWidth: 2,
                        hidden: false,
                        yAxisID: 'TASKS',
                    }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    title: {
                        display: false
                    },
                    legend: {
                        display: screen.width > 767,
                        position: 'right'
                    },
                    lineAtIndex: 60,
                    scales: {
                        yAxes: [{
                            id: 'TASKS',
                            position: 'left',
                            ticks: {
                                max: Math.max.apply(Math, [...runningTasks, ...highPriorityTasks, ...lowPriorityTasks, ...totalTasks]) + 5,
                                beginAtZero: true
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Num Tasks'
                            }
                        }, {
                            id: 'WORKERS',
                            position: 'right',
                            ticks: {
                                max: Math.max.apply(Math, maxWorkersList) + 5,
                                callback: function (value) {
                                    if (value % 1 === 0) {
                                        return value;
                                    }
                                }
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Num Workers'
                            }
                        }]
                    }
                }
            });
        }
    </script>
    <style>
        .divchartcontainer {
            max-height: 45vh;
            height: 45vh;
            padding: 5px;
        }

        canvas {
            margin: auto;
            height: inherit !important;
            width: auto !important;
        }
    </style>
    <div class="divchartcontainer" id="chart-container"></div>
</div>
</div>